// نصوص واجهة ثنائية اللغة
const translations = {
  en: {
    "site-title": "Bassam Alotaibi",
    "home": "Home",
    "projects": "Projects",
    "experience": "Experience",
    "contact": "Contact",

    "hero-title": "Welcome! I'm a Cyber Security and AI Researcher",
    "hero-subtitle": "I’m driving research at the intersection of AI and cybersecurity—advancing intelligent threat detection, privacy-preserving models, and ethical AI adoption. Explore my work and let’s secure the future together.",
    "view-projects": "View Projects",
    "hire-me": "Hire Me",

    "about-heading": "About Me",
    "about-paragraph": "I work at the intersection of cybersecurity and AI, helping organisations adopt new technologies securely and ethically. With a foundation in IT operations and a Master’s in Cybersecurity from Lancaster University, my work bridges research and practice—linking governance with real-world technology.\n I currently serve as Information Security Manager at Experience (a SAMA-regulated financial company) and chair Buniah, the Saudi Association for AI and Data, supporting non-profits in leveraging AI and data responsibly.\n\nMy interests span distributed systems security, privacy-preserving machine learning, and AI governance for non-profits and emerging sectors.",

    "projects-heading": "Projects",
    "project1-title": "Master’s Thesis - A Peer-to-Peer Federated Learning Framework for Intrusion Detection in Autonomous Vehicles",
    "project1-points": [
      "Developed a decentralized federated learning framework to enhance intrusion detection in autonomous vehicles while preserving data privacy.",
      "Developed and tested the SR-1CNN model, reaching 94.39% accuracy on NSL-KDD and 99.97% on the Car Hacking dataset.",
      "Addressed data heterogeneity challenges and demonstrated the framework’s effectiveness in both independent and non-independent data distributions.",
      "Eliminated dependence on centralized servers by implementing asynchronous parameter sharing in a mesh topology, improving the system’s resilience against single points of failure.",
      "The project is associated with the Cybersecurity Research Center at Lancaster University."
    ],
    "view-github": "GitHub",

    "experience-heading": "Experience",
    "contact-heading": "Send a Message",
    "send": "Send",
    "contact-info-heading": "Contact Info",
    "email": "Email:",
    "contactEmail": "Contact with Email",
    "phone": "Phone:",
    "whatsapp": "WhatsApp:",
    "chatWhatsapp": "Chat on WhatsApp",

    "footer-text": "© {year} Bassam Alotaibi"
  },
  ar: {
    "site-title": "بسام العتيبي",
    "home": "الرئيسية",
    "projects": "المشاريع",
    "experience": "الخبرة",
    "contact": "تواصل",

    "hero-title": "مرحبًا! أنا باحث في الأمن السيبراني والذكاء الاصطناعي",
    "hero-subtitle": "أقود أبحاثًا في تقاطع الذكاء الاصطناعي والأمن السيبراني — أعمل على تطوير أنظمة ذكية لاكتشاف التهديدات، ونماذج تحافظ على الخصوصية، واعتماد الذكاء الاصطناعي بشكل أخلاقي. استكشف أعمالي ولنؤمّن المستقبل معًا.",
    "view-projects": "عرض المشاريع",
    "hire-me": "توظيفي",

    "about-heading": "عنّي",
    "about-paragraph": "أعمل في تقاطع الأمن السيبراني والذكاء الاصطناعي، حيث أساعد المؤسسات على تبني التقنيات الحديثة بشكل آمن وأخلاقي. وبفضل خلفيتي في إدارة تكنولوجيا المعلومات وحصولي على ماجستير في الأمن السيبراني من جامعة لانكستر، فإن عملي يجمع بين البحث والتطبيق العملي — رابطًا بين الحوكمة والتقنية في الواقع.\n أشغل حاليًا منصب مدير أمن المعلومات في شركة Experience (وهي شركة مالية خاضعة لتنظيم مؤسسة النقد العربي السعودي \"ساما\")، كما أرأس جمعية بُنية — الجمعية السعودية للذكاء الاصطناعي والبيانات — لدعم المنظمات غير الربحية في الاستفادة من الذكاء الاصطناعي والبيانات بطريقة مسؤولة.\n\nاهتماماتي تتنوع بين أمن الأنظمة الموزعة، والتعلم الآلي المحافظ على الخصوصية، وحوكمة الذكاء الاصطناعي للمنظمات غير الربحية والقطاعات الناشئة.",

    "projects-heading": "المشاريع",
    "project1-title": "رسالة الماجستير - إطار تعلم اتحادي نظير-لنظير لاكتشاف التسلل في المركبات الذاتية القيادة",
    "project1-points": [
      "تطوير إطار تعلم اتحادي لامركزي لتعزيز اكتشاف التهديدات في المركبات ذاتية القيادة مع الحفاظ على خصوصية البيانات.",
      "تطوير واختبار نموذج SR-1CNN محققًا دقة 94.39% على مجموعة بيانات NSL-KDD و 99.97% على مجموعة بيانات Car Hacking.",
      "معالجة تحديات تباين البيانات وإثبات فعالية الإطار في التوزيعات المستقلة وغير المستقلة للبيانات.",
      "إلغاء الاعتماد على الخوادم المركزية من خلال تنفيذ مشاركة غير متزامنة للمعلمات في طوبولوجيا شبكية، مما عزز مرونة النظام ضد نقاط الفشل الأحادية.",
      "المشروع مرتبط بمركز أبحاث الأمن السيبراني في جامعة لانكستر."
    ],
    "view-github": "جيتهاب",

    "experience-heading": "الخبرة",
    "education-heading":"التعليم",
    "contact-heading": "إرسال رسالة",
    "send": "إرسال",
    "contact-info-heading": "معلومات التواصل",
    "email": "البريد الإلكتروني:",
    "contactEmail": "تواصل عبر البريد",
    "phone": "الهاتف:",
    "whatsapp": "واتساب:",
    "chatWhatsapp": "الدردشة عبر واتساب",
    
    "footer-text": "© {year} بسام العتيبي"
  }
};

// عناصر اللغة
const enBtn = document.getElementById("en-btn");
const arBtn = document.getElementById("ar-btn");

// تحميل/حفظ اللغة
const STORAGE_KEY = "siteLang";
function getInitialLang(){
  const saved = localStorage.getItem(STORAGE_KEY);
  if (saved) return saved;
  return "ar"; // الافتراضية
}

function setLanguage(lang){
  localStorage.setItem(STORAGE_KEY, lang);
  document.documentElement.lang = lang;
  document.documentElement.dir = (lang === "ar" ? "rtl" : "ltr");

  const dict = translations[lang];

  // تحديث العناصر بالـ id
  document.querySelectorAll("[id]").forEach(el=>{
    const key = el.id;
    if (dict[key]){
      const val = dict[key].replace
        ? dict[key].replace("{year}", new Date().getFullYear())
        : dict[key];
      if (el.tagName === "INPUT" || el.tagName === "TEXTAREA"){
        el.placeholder = val;
      } else if (!Array.isArray(dict[key])) {  
        el.textContent = val;
      }
    }
  });

  const sendBtn = document.getElementById("send-btn");
  if (sendBtn && dict.send) sendBtn.textContent = dict.send;


  // تحديث العناصر بالـ data-key
  document.querySelectorAll("[data-key]").forEach(el=>{
    const key = el.getAttribute("data-key");
    if (dict[key]) el.textContent = dict[key];
  });

  // تحديث المشاريع (قوائم Array)
  document.querySelectorAll("ul[id]").forEach(el=>{
    const key = el.id;
    if (Array.isArray(dict[key])) {
      el.innerHTML = dict[key].map(item=> `<li>${item}</li>`).join("");
    }
  });

  // تحديث Contact Info بشكل ديناميكي
  const gmailLink = document.getElementById("gmail-link");
  if (gmailLink && dict.contactEmail) gmailLink.textContent = dict.contactEmail;

  const waLink = document.getElementById("wa-link");
  if (waLink && dict.chatWhatsapp) waLink.textContent = dict.chatWhatsapp;

  const phoneEl = document.querySelector("[data-key='phone']");
  if (phoneEl && dict.phone) phoneEl.textContent = dict.phone;

  // إذا أردت يمكن إضافة strong للبريد والواتساب بعلامة data-key="email" و "whatsapp"
  const emailStrong = document.querySelector("[data-key='email']");
  if (emailStrong && dict.email) emailStrong.textContent = dict.email;

  const waStrong = document.querySelector("[data-key='whatsapp']");
  if (waStrong && dict.whatsapp) waStrong.textContent = dict.whatsapp;
}

// ربط الأزرار
if (enBtn) enBtn.addEventListener("click", ()=> setLanguage("en"));
if (arBtn) arBtn.addEventListener("click", ()=> setLanguage("ar"));

// سنة الفوتر
const yearEl = document.getElementById("year");
if (yearEl) yearEl.textContent = new Date().getFullYear();

// تطبيق اللغة عند تحميل الصفحة
setLanguage(getInitialLang());

// أنيميشن عند التمرير
const observer = new IntersectionObserver((entries)=>{
  entries.forEach(entry=>{
    if (entry.isIntersecting){
      entry.target.style.opacity = 1;
      entry.target.style.transform = "translate(0,0)";
      observer.unobserve(entry.target);
    }
  });
}, {threshold: .15});

document.querySelectorAll(".fade-up, .fade-left").forEach(el=> observer.observe(el));

// رابط واتساب تلقائي (اختياري)
(function autoWhatsApp(){
  const wa = document.getElementById("wa-link");
  if (wa && (!wa.getAttribute("href") || wa.getAttribute("href")==="#")){
    const phone = "201234567890"; // عدّل الرقم
    wa.setAttribute("href", `https://wa.me/${phone}`);
  }
})();